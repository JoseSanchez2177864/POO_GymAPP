<Configp>:
    name: "configuracion"
    FloatLayout:
        md_bg_color: 0.05, 0.05, 0.05, 1

        MDBoxLayout:
            orientation: "vertical"
            size_hint: 0.9, 0.85
            pos_hint: {"center_x": 0.5, "center_y": 0.55}
            spacing: dp(10)
            padding: dp(10)
            md_bg_color: 0.15, 0.15, 0.15, 1
            radius: [15, 15, 15, 15]

            MDLabel:
                text: "CONFIGURACIÓN DE USUARIO"
                font_style: "H4"
                halign: "center"
                theme_text_color: "Custom"
                text_color: 1, 1, 1, 1
                bold: True

            ScrollView:
                do_scroll_x: False

                MDBoxLayout:
                    orientation: "vertical"
                    spacing: dp(6)
                    padding: 0
                    size_hint_y: None
                    height: self.minimum_height

                    # Datos de usuario
                    MDLabel:
                        text: "Nombre"
                        font_style: "Subtitle1"
                        halign: "left"
                        theme_text_color: "Custom"
                        text_color: 1, 0, 0, 1
                        size_hint_y: None
                        height: self.texture_size[1]
                    MDLabel:
                        text: "{} {}".format(root.nombre, root.apellidos)
                        font_style: "Body1"
                        halign: "left"
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        size_hint_y: None
                        height: self.texture_size[1]

                    MDLabel:
                        text: "Nombre de Usuario"
                        font_style: "Subtitle1"
                        halign: "left"
                        theme_text_color: "Custom"
                        text_color: 1, 0, 0, 1
                        size_hint_y: None
                        height: self.texture_size[1]
                    MDLabel:
                        text: root.nombreusuario
                        font_style: "Body1"
                        halign: "left"
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        size_hint_y: None
                        height: self.texture_size[1]

                    MDLabel:
                        text: "Correo"
                        font_style: "Subtitle1"
                        halign: "left"
                        theme_text_color: "Custom"
                        text_color: 1, 0, 0, 1
                        size_hint_y: None
                        height: self.texture_size[1]
                    MDLabel:
                        text: root.correo
                        font_style: "Body1"
                        halign: "left"
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        size_hint_y: None
                        height: self.texture_size[1]

            MDBoxLayout:
                orientation: "vertical"
                size_hint_y: None
                height: dp(210)
                spacing: dp(15)
                padding: 0, dp(10)

                MDRaisedButton:
                    text: "Editar Usuarios"
                    icon: "pencil"
                    font_size: dp(14)
                    size_hint: None, None
                    size: dp(200), dp(45)
                    md_bg_color: 0.8, 0.1, 0.1, 1
                    on_release: app.root.current = 'pantalla7'
                    opacity: 1 if root.rol == 1 else 0
                    disabled: root.rol != 1
                    pos_hint: {"center_x": 0.5}

                MDRaisedButton:
                    text: "Cambiar contraseña"
                    md_bg_color: 0.8, 0.1, 0.1, 1
                    size_hint_x: 0.9
                    pos_hint: {"center_x": 0.5}
                    on_release: root.mostrar_popup_contrasena()

                MDRaisedButton:
                    text: "Actualizar información"
                    md_bg_color: 0.8, 0.1, 0.1, 1
                    size_hint_x: 0.9
                    pos_hint: {"center_x": 0.5}
                    on_release: root.mostrar_popup_info()
                
                MDRaisedButton:
                    text: "Cerrar sesión"
                    md_bg_color: 0.8, 0.1, 0.1, 1
                    size_hint_x: 0.9
                    pos_hint: {"center_x": 0.5}
                    on_release: app.root.get_screen('pantalla3').cerrar_sesion()
                Widget:
                    size_hint_x: 1.5
        # Separador fijo
        MDSeparator:
            height: dp(1)
            md_bg_color: 0.4, 0.4, 0.4, 1
            pos_hint: {"center_x": 0.5, "center_y": 0.11}

        # Barra inferior fija como en CRUDpp
        MDBoxLayout:
            orientation: 'horizontal'
            size_hint_y: None
            height: dp(50)
            padding: dp(10), 0
            spacing: dp(10)
            pos_hint: {"center_x": 0.5, "y": 0.02}

            MDIconButton:
                icon: "home"
                user_font_size: "24sp"
                md_bg_color: 0.8, 0.1, 0.1, 1
                theme_text_color: "Custom"
                text_color: 1, 1, 1, 1
                on_release: app.root.current = 'pantalla3'

            MDIconButton:
                icon: "clipboard-list"
                user_font_size: "24sp"
                theme_text_color: "Custom"
                text_color: 1, 1, 1, 1
                md_bg_color: 0.8, 0.1, 0.1, 1
                on_release: root.redirigir_por_rol()

            Widget:
                size_hint_x: 0.5

            MDIconButton:
                icon: "plus"
                user_font_size: "24sp"
                theme_text_color: "Custom"
                text_color: 1, 1, 1, 1
                md_bg_color: 0.8, 0.1, 0.1, 1
                on_release: root.agregar_usuario()

            Widget:
                size_hint_x: 0.5

            MDIconButton:
                icon: "chart-bar"
                user_font_size: "24sp"
                theme_text_color: "Custom"
                text_color: 1, 1, 1, 1
                md_bg_color: 0.8, 0.1, 0.1, 1
                on_release: app.redirigir_por_rol2()

            MDIconButton:
                icon: "account"
                user_font_size: "24sp"
                md_bg_color: 0.8, 0.1, 0.1, 1
                theme_text_color: "Custom"
                text_color: 1, 1, 1, 1
                on_release: app.root.current = 'pantalla5'
